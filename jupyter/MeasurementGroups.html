<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Optimize Measurements by grouping into commuting cliques &#8212; tequila 0.0.3 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Training Distributions with KM Divergence" href="OptimizeDistributions.html" />
    <link rel="prev" title="Tequila Tutorial:" href="SciPyOptimizers.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          Tequila</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href=".././tequila_presentation.html">Overview</a></li>
                <li><a href=".././README.html">Installation</a></li>
                <li><a href=".././package/index.html">API</a></li>
                <li><a href="https://github.com/aspuru-guzik-group/tequila">GitHub</a></li>
                <li><a href=".././tutorials.html">Tutorials</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Tequila</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#quantum-backends">Quantum Backends</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#quantumchemistry">QuantumChemistry:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#getting-started">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#dependencies">Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#documentation">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#troubleshooting">Troubleshooting</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../package/index.html">Tequila Library Reference</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="SciPyOptimizers.html" title="Previous Chapter: Tequila Tutorial:"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Tequila Tutorial:</span>
    </a>
  </li>
  <li>
    <a href="OptimizeDistributions.html" title="Next Chapter: Training Distributions with KM Divergence"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Training Dist... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/jupyter/MeasurementGroups.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="optimize-measurements-by-grouping-into-commuting-cliques">
<h1>Optimize Measurements by grouping into commuting cliques<a class="headerlink" href="#optimize-measurements-by-grouping-into-commuting-cliques" title="Permalink to this headline">¶</a></h1>
<p>Quantum mechanics allows simultaneuous measurements of all mutually
commuting operators. VQE however permits only the measurements of a much
more restricted set of operators, the qubit-wise commuting operators
(Verteletskyi et al., “Measurement Optimization in the Variational
Quantum Eigensolver Using a Minimum Clique Cover” <a class="reference external" href="https://doi.org/10.1063/1.5141458">J. Chem. Phys. 152,
124114 (2020)</a>). But through
certain unitary transformations any group of mutually commuting
operators can be tranformed into their qubit-wise commuting form (Yen et
al., “Measuring all compatible operators in one series of single-qubit
measurements using unitary transformations” <a class="reference external" href="https://doi.org/10.1021/acs.jctc.0c00008">Chem. Theory Comput. 2020,
16, 4, 2400–2409</a>).</p>
<div class="section" id="how-to-use">
<h2>How to Use:<a class="headerlink" href="#how-to-use" title="Permalink to this headline">¶</a></h2>
<p>This is how the technique can be used in tequila. Note that you will
only benefit from optimizing measurements when you are running on a real
quantum backend or when you simulate with finite samples. The difference
in timings is just an indicator that different processes happen, in this
specific example we have an Hamiltonian with 4 terms where optimization
of the measurements reduces those to 2 commuting groups (see the next
section for details)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tequila</span> <span class="k">as</span> <span class="nn">tq</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="n">tq</span><span class="o">.</span><span class="n">show_available_simulators</span><span class="p">()</span>
<span class="n">backend</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">H</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">paulis</span><span class="o">.</span><span class="n">Z</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">tq</span><span class="o">.</span><span class="n">paulis</span><span class="o">.</span><span class="n">Y</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">tq</span><span class="o">.</span><span class="n">paulis</span><span class="o">.</span><span class="n">X</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">tq</span><span class="o">.</span><span class="n">paulis</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">tq</span><span class="o">.</span><span class="n">paulis</span><span class="o">.</span><span class="n">Z</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>

<span class="n">U</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">gates</span><span class="o">.</span><span class="n">ExpPauli</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">paulistring</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">PauliString</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s1">&#39;X(0)Y(1)&#39;</span><span class="p">))</span>
<span class="n">U</span> <span class="o">+=</span> <span class="n">tq</span><span class="o">.</span><span class="n">gates</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>

<span class="n">E1</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">ExpectationValue</span><span class="p">(</span><span class="n">H</span><span class="o">=</span><span class="n">H</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="n">U</span><span class="p">)</span>
<span class="n">E2</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">ExpectationValue</span><span class="p">(</span><span class="n">H</span><span class="o">=</span><span class="n">H</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="n">U</span><span class="p">,</span> <span class="n">optimize_measurements</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">E1</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">},</span> <span class="n">samples</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;time : </span><span class="si">{}</span><span class="s2">s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">start</span><span class="p">))</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">E2</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">},</span> <span class="n">samples</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;time : </span><span class="si">{}</span><span class="s2">s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">start</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="behind-the-scenes">
<h2>Behind the Scenes<a class="headerlink" href="#behind-the-scenes" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tequila</span> <span class="k">as</span> <span class="nn">tq</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">tequila.hamiltonian</span> <span class="kn">import</span> <span class="n">QubitHamiltonian</span><span class="p">,</span> <span class="n">paulis</span>
<span class="kn">from</span> <span class="nn">tequila.grouping.binary_rep</span> <span class="kn">import</span> <span class="n">BinaryHamiltonian</span>
</pre></div>
</div>
<p>The following examples shows how to partition a given Hamiltonian into
commuting parts and how to find the unitary transformation needed to
transform the commuting terms into qubit-wise commuting form that is
easy to measure.</p>
<p>The Hamiltonian is simply</p>
<div class="math notranslate nohighlight">
\[H = \sigma_z(0)\sigma_z(1) + \sigma_y(0)\sigma_y(1) + \sigma_x(0)\sigma_x(1) + \sigma_x(0)\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma_z(0)\sigma_z(1)\)</span>, <span class="math notranslate nohighlight">\(\sigma_y(0)\sigma_y(1)\)</span>
does not commute with <span class="math notranslate nohighlight">\(\sigma_x(0)\)</span>, so two separate measurements
are needed.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H</span> <span class="o">=</span> <span class="n">paulis</span><span class="o">.</span><span class="n">Z</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">paulis</span><span class="o">.</span><span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">paulis</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">paulis</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> \
    <span class="n">paulis</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">paulis</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">paulis</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Here we use the binary representation of the Hamiltonian for
partitioning. The method commuting_groups gets back a list of
BinaryHamiltonian whose terms are mutually commuting.</p>
<p>Call to_qubit_hamiltonian to visualize.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">binary_H</span> <span class="o">=</span> <span class="n">BinaryHamiltonian</span><span class="o">.</span><span class="n">init_from_qubit_hamiltonian</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="n">commuting_parts</span> <span class="o">=</span> <span class="n">binary_H</span><span class="o">.</span><span class="n">commuting_groups</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">commuting_parts</span><span class="p">))</span> <span class="c1"># Number of measurements needed</span>
<span class="nb">print</span><span class="p">(</span><span class="n">commuting_parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_qubit_hamiltonian</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">commuting_parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">to_qubit_hamiltonian</span><span class="p">())</span>
</pre></div>
</div>
<p>The second group of terms <span class="math notranslate nohighlight">\(H_2\)</span> are not currently qubit-wise
commuting and cannot be directly measured on current hardware. They
require further unitary transformation <span class="math notranslate nohighlight">\(U\)</span> to become qubit-wise
commuting. The following code identifies two bases (list of
BinaryPauliString) that encodes the unitary transformation as</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}U = \prod_i \frac{1}{\sqrt{2}} (\text{old_basis}[i] + \text{new_basis}[i])\\such that :math:`UH_2U` is qubit-wise commuting.\end{aligned}\end{align} \]</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qubit_wise_parts</span><span class="p">,</span> <span class="n">old_basis</span><span class="p">,</span> <span class="n">new_basis</span> <span class="o">=</span> <span class="n">commuting_parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">single_qubit_form</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">display_basis</span><span class="p">(</span><span class="n">basis</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">basis</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">QubitHamiltonian</span><span class="o">.</span><span class="n">from_paulistrings</span><span class="p">(</span><span class="n">term</span><span class="o">.</span><span class="n">to_pauli_strings</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Old Basis&#39;</span><span class="p">)</span>
<span class="n">display_basis</span><span class="p">(</span><span class="n">old_basis</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">New Basis&#39;</span><span class="p">)</span>
<span class="n">display_basis</span><span class="p">(</span><span class="n">new_basis</span><span class="p">)</span>
</pre></div>
</div>
<p>The transfromed term <span class="math notranslate nohighlight">\(UH_2U\)</span> is qubit-wise commuting.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">qubit_wise_parts</span><span class="o">.</span><span class="n">to_qubit_hamiltonian</span><span class="p">())</span>
</pre></div>
</div>
<p>Get the circuit for the unitary transformation to implement the
measurement scheme. The next function illustrates what is happening if
expectation values are formed with the <code class="docutils literal notranslate"><span class="pre">optimize_measurements</span></code> keyword
meaning it does the same as
<code class="docutils literal notranslate"><span class="pre">tq.ExpectationValue(H=H,U=U,</span> <span class="pre">optimize_measurements=True)</span></code></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">optimize_measurements</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">U</span><span class="p">):</span>
    <span class="n">binary_H</span> <span class="o">=</span> <span class="n">BinaryHamiltonian</span><span class="o">.</span><span class="n">init_from_qubit_hamiltonian</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
    <span class="n">commuting_parts</span> <span class="o">=</span> <span class="n">binary_H</span><span class="o">.</span><span class="n">commuting_groups</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">cH</span> <span class="ow">in</span> <span class="n">commuting_parts</span><span class="p">:</span>
        <span class="n">qwc</span><span class="p">,</span> <span class="n">Um</span> <span class="o">=</span> <span class="n">cH</span><span class="o">.</span><span class="n">get_qubit_wise</span><span class="p">()</span>
        <span class="n">Etmp</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">ExpectationValue</span><span class="p">(</span><span class="n">H</span><span class="o">=</span><span class="n">qwc</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="n">U</span><span class="o">+</span><span class="n">Um</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="n">Etmp</span>

    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
<p>The new measurement scheme produces the same expectation values</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">gates</span><span class="o">.</span><span class="n">ExpPauli</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">paulistring</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">PauliString</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s1">&#39;X(0)Y(1)&#39;</span><span class="p">))</span>
<span class="n">E1</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">ExpectationValue</span><span class="p">(</span><span class="n">H</span><span class="o">=</span><span class="n">commuting_parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">to_qubit_hamiltonian</span><span class="p">(),</span> <span class="n">U</span><span class="o">=</span><span class="n">U</span><span class="p">)</span>
<span class="n">E2</span> <span class="o">=</span> <span class="n">optimize_measurements</span><span class="p">(</span><span class="n">H</span><span class="o">=</span><span class="n">commuting_parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">to_qubit_hamiltonian</span><span class="p">(),</span> <span class="n">U</span><span class="o">=</span><span class="n">U</span><span class="p">)</span>

<span class="n">variables</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;a&quot;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">}</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Without measurement grouping&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">E1</span><span class="p">,</span> <span class="n">variables</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">With measurement grouping&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">E2</span><span class="p">,</span> <span class="n">variables</span><span class="p">))</span>
</pre></div>
</div>
<p>The get_qubit_wise methods always transforms the hamiltonian into the
qubit-wise commuting form with only z on each qubit. This is done via
extra single-qubit unitaries.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The qubit-wise commuting hamiltonian, but does not have all z&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">commuting_parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_qubit_hamiltonian</span><span class="p">())</span>

<span class="n">qwc</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">commuting_parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_qubit_wise</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">The same qubit-wise commuting hamiltonian with all z&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qwc</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">The corresponding single qubit unitaries&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2020, Matter Lab.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.2.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>