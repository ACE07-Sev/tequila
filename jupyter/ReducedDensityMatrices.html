<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Reduced Density Matrices in Tequila &#8212; tequila 0.0.3 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tequila Tutorial:" href="SingleQubitClassifier.html" />
    <link rel="prev" title="Exploring the application of quantum circuits in convolutional neural networks" href="Quanvolutional_Neural_Networks.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          Tequila</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href=".././tequila_presentation.html">Overview</a></li>
                <li><a href=".././README.html">Installation</a></li>
                <li><a href=".././package/index.html">API</a></li>
                <li><a href="https://github.com/aspuru-guzik-group/tequila">GitHub</a></li>
                <li><a href=".././tutorials.html">Tutorials</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Tequila</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#quantum-backends">Quantum Backends</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#quantumchemistry">QuantumChemistry:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#getting-started">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#dependencies">Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#documentation">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#troubleshooting">Troubleshooting</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../package/index.html">Tequila Library Reference</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="Quanvolutional_Neural_Networks.html" title="Previous Chapter: Exploring the application of quantum circuits in convolutional neural networks"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Exploring the...</span>
    </a>
  </li>
  <li>
    <a href="SingleQubitClassifier.html" title="Next Chapter: Tequila Tutorial:"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Tequila Tutorial: &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/jupyter/ReducedDensityMatrices.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="reduced-density-matrices-in-tequila">
<h1>Reduced Density Matrices in Tequila<a class="headerlink" href="#reduced-density-matrices-in-tequila" title="Permalink to this headline">¶</a></h1>
<p>This notebook serves as a tutorial to the computation and usage of the
one- and two-particle reduced density matrices.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tequila</span> <span class="k">as</span> <span class="nn">tq</span>
<span class="kn">import</span> <span class="nn">numpy</span>
</pre></div>
</div>
<div class="section" id="the-1-and-2-rdm">
<h2>The 1- and 2-RDM<a class="headerlink" href="#the-1-and-2-rdm" title="Permalink to this headline">¶</a></h2>
<p>First, look at the definition of the reduced density matrices (RDM) for
some state <span class="math notranslate nohighlight">\(|\psi\rangle\)</span>:</p>
<p>1-RDM: <span class="math notranslate nohighlight">\(\gamma^p_q\equiv\langle\psi|a^pa_q|\psi\rangle\)</span></p>
<p>2-RDM <span class="math notranslate nohighlight">\(\gamma^{pq}_{rs}\equiv\langle\psi|a^pa^qa_sa_r|\psi\rangle\)</span>
(we mainly use the standard physics ordering for the second-quantized
operators, i.e. <span class="math notranslate nohighlight">\(p,r\)</span> go with particle 1 and <span class="math notranslate nohighlight">\(q,s\)</span> with
particle 2)</p>
<p>The operators <span class="math notranslate nohighlight">\(a^p=a_p^\dagger\)</span> and <span class="math notranslate nohighlight">\(a_p\)</span> denote the
standard fermionic creation and annihilation operators.</p>
<p>Since we work on a quantum computer, <span class="math notranslate nohighlight">\(|\psi\rangle\)</span> is represented
by some unitary transformation <span class="math notranslate nohighlight">\(U\)</span>:
<span class="math notranslate nohighlight">\(|\psi\rangle=U|0\rangle^{\otimesN_q}\)</span>, using <span class="math notranslate nohighlight">\(N_q\)</span> qubits.
This corresponds to <span class="math notranslate nohighlight">\(N_q\)</span> spin-orbitals in Jordan-Wigner encoding.
Obtaining the RDMs from a quantum computer is most intuitive when using
the Jordan-Wigner transformation, since the results directly correspond
to the ones computed classically in second quantized form.</p>
<p>It is worth mentioning that since we only consider real orbitals in
chemistry applications, the implementation also expects only real-valued
RDM’s. The well-known anticommutation relations yield a series of
symmetry properties for the reduced density matrices, which can be taken
into consideration to reduce the computational cost:</p>
<p>In chemistry applications, solving the electronic structure problem
involves the electronic Hamiltonian (here in Born-Oppenheimer
approximation)</p>
<div class="math notranslate nohighlight">
\[H_{el} = h_0 + \sum_{pq} h^q_p a^p_q + \frac{1}{2}\sum_{pqrs} h^{rs}_{pq} a^{pq}_{rs}\]</div>
<p>with the one- and two-body integrals <span class="math notranslate nohighlight">\(h^q_p, h^{rs}_{pq}\)</span> that
turn out to be independent of spin.</p>
<p>Therefore, we introduce the spin-free RDMs <span class="math notranslate nohighlight">\(\Gamma^P_Q\)</span> and
<span class="math notranslate nohighlight">\(\Gamma^{PQ}_{RS}\)</span>, obtained by spin-summation (we write molecular
orbitals in uppercase letters <span class="math notranslate nohighlight">\(P,Q,\ldots\in\{1,\ldots,N_p\}\)</span> in
opposite to spin-orbitals <span class="math notranslate nohighlight">\(p,q,\ldots\in\{1,\ldots,N_q\}\)</span>):</p>
<p>Note, that by making use of linearity, we obtain the second equality in
the two expressions above. Performing the summation before evaluating
the expected value means less expected values and a considerable
reduction in computational cost (only <span class="math notranslate nohighlight">\(N_p=\frac{N_q}{2}\)</span>
molecular orbitals vs. <span class="math notranslate nohighlight">\(N_q\)</span> spin-orbitals).</p>
<p>Due to the orthogonality of the spin states, the symmetries for the
spin-free 2-RDM are slightly less than for the spin-orbital RDM:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># As an example, let&#39;s use the Helium atom in a minimal basis</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">chemistry</span><span class="o">.</span><span class="n">Molecule</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span><span class="s1">&#39;He 0.0 0.0 0.0&#39;</span><span class="p">,</span> <span class="n">basis_set</span><span class="o">=</span><span class="s1">&#39;6-31g&#39;</span><span class="p">)</span>

<span class="c1"># We want to get the 1- and 2-RDM for the (approximate) ground state of Helium</span>
<span class="c1"># For that, we (i) need to set up a unitary transformation U(angles)</span>
<span class="c1">#             (ii) determine a set of angles using VQE s.th. U(angles) |0&gt; = |psi&gt;, where H|psi&gt; = E_0|psi&gt;</span>
<span class="c1">#            (iii) compute the RDMs using compute_rdms</span>

<span class="c1"># (i) Set up a circuit</span>
<span class="c1"># This can be done either using the make_uccsd-method (see Chemistry-tutorial) or by a hand-written circuit</span>
<span class="c1"># We use a hand-written circuit here</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">gates</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">U</span> <span class="o">+=</span> <span class="n">tq</span><span class="o">.</span><span class="n">gates</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">U</span> <span class="o">+=</span> <span class="n">tq</span><span class="o">.</span><span class="n">gates</span><span class="o">.</span><span class="n">Ry</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">control</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="s1">&#39;a1&#39;</span><span class="p">)</span>
<span class="n">U</span> <span class="o">+=</span> <span class="n">tq</span><span class="o">.</span><span class="n">gates</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">U</span> <span class="o">+=</span> <span class="n">tq</span><span class="o">.</span><span class="n">gates</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">control</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">U</span> <span class="o">+=</span> <span class="n">tq</span><span class="o">.</span><span class="n">gates</span><span class="o">.</span><span class="n">Ry</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">control</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="s1">&#39;a2&#39;</span><span class="p">)</span>
<span class="n">U</span> <span class="o">+=</span> <span class="n">tq</span><span class="o">.</span><span class="n">gates</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">U</span> <span class="o">+=</span> <span class="n">tq</span><span class="o">.</span><span class="n">gates</span><span class="o">.</span><span class="n">Ry</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">control</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="s1">&#39;a3&#39;</span><span class="p">)</span>
<span class="n">U</span> <span class="o">+=</span> <span class="n">tq</span><span class="o">.</span><span class="n">gates</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">U</span> <span class="o">+=</span> <span class="n">tq</span><span class="o">.</span><span class="n">gates</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">U</span> <span class="o">+=</span> <span class="n">tq</span><span class="o">.</span><span class="n">gates</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">control</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">U</span> <span class="o">+=</span> <span class="n">tq</span><span class="o">.</span><span class="n">gates</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># (ii) Run VQE</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">make_hamiltonian</span><span class="p">()</span>
<span class="n">O</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">objective</span><span class="o">.</span><span class="n">objective</span><span class="o">.</span><span class="n">ExpectationValue</span><span class="p">(</span><span class="n">H</span><span class="o">=</span><span class="n">H</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="n">U</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">objective</span><span class="o">=</span><span class="n">O</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bfgs&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># (iii) Using the optimal parameters out of VQE, we know have a circuit U_opt |0&gt; ~ U|0&gt; = |psi&gt;</span>
<span class="n">mol</span><span class="o">.</span><span class="n">compute_rdms</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">U</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">angles</span><span class="p">,</span> <span class="n">spin_free</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">get_rdm1</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">get_rdm2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rdm1_spinfree</span><span class="p">,</span> <span class="n">rdm2_spinfree</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">rdm1</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">rdm2</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">The spin-free matrices:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1-RDM:</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rdm1_spinfree</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;2-RDM:</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rdm2_spinfree</span><span class="p">))</span>


<span class="c1"># Let&#39;s also get the spin-orbital rdm2</span>
<span class="c1"># We can select to only determine one of either matrix, but if both are needed at some point, it is</span>
<span class="c1"># more efficient to compute both within one call of compute_rdms</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">The spin-ful matrices:&#39;</span><span class="p">)</span>
<span class="n">mol</span><span class="o">.</span><span class="n">compute_rdms</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">U</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">angles</span><span class="p">,</span> <span class="n">spin_free</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">get_rdm1</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">get_rdm2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rdm1_spin</span><span class="p">,</span> <span class="n">rdm2_spin</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">rdm1</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">rdm2</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1-RDM is None now: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rdm1_spin</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;2-RDM has been determined:</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rdm2_spin</span><span class="p">))</span>

<span class="c1"># We can compute the 1-rdm still at a later point</span>
<span class="n">mol</span><span class="o">.</span><span class="n">compute_rdms</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">U</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">angles</span><span class="p">,</span> <span class="n">spin_free</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">get_rdm1</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">get_rdm2</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">rdm1_spin</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">rdm1</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1-RDM is also here now:</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rdm1_spin</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To check consistency with the spin-free rdms, we can do spin-summation afterwards</span>
<span class="c1"># (again, if only the spin-free version is of interest, it is cheaper to get it right from compute_rdms)</span>
<span class="n">rdm1_spinsum</span><span class="p">,</span> <span class="n">rdm2_spinsum</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">rdm_spinsum</span><span class="p">(</span><span class="n">sum_rdm1</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sum_rdm2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Consistency of spin summation:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1-RDM: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">rdm1_spinsum</span><span class="p">,</span> <span class="n">rdm1_spinfree</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;2-RDM: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">rdm2_spinsum</span><span class="p">,</span> <span class="n">rdm2_spinfree</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We can also compute the RDMs using the psi4-interface.</span>
<span class="c1"># Then, psi4 is called to perform a CI-calculation, while collecting the 1- and 2-RDM</span>
<span class="c1"># Let&#39;s use full CI here, but other CI flavors work as well</span>
<span class="n">mol</span><span class="o">.</span><span class="n">compute_rdms</span><span class="p">(</span><span class="n">psi4_method</span><span class="o">=</span><span class="s1">&#39;fci&#39;</span><span class="p">)</span>
<span class="n">rdm1_psi4</span><span class="p">,</span> <span class="n">rdm2_psi4</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">rdm1</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">rdm2</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Psi4-RDMs:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1-RDM:</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rdm1_psi4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;2-RDM:</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rdm2_psi4</span><span class="p">))</span>

<span class="c1"># Comparing the results to the VQE-matrices, we observe a close resemblance,</span>
<span class="c1"># also suggested by the obtained energies</span>
<span class="n">fci_energy</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">logs</span><span class="p">[</span><span class="s1">&#39;fci&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;FCI TOTAL ENERGY&#39;</span><span class="p">]</span>
<span class="n">vqe_energy</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">energy</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">FCI energy: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fci_energy</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;VQE-Energy: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">vqe_energy</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="consistency-checks">
<h2>Consistency checks<a class="headerlink" href="#consistency-checks" title="Permalink to this headline">¶</a></h2>
<p>At this point, we can make a few consistency checks.</p>
<p>We can validate the trace condition for the 1- and 2-RDM:</p>
<p><span class="math notranslate nohighlight">\(N\)</span> describes the number of particles involved, i.e. in our case
using a minimal basis this corresponds to <span class="math notranslate nohighlight">\(N_p\)</span> above. For the
Helium atom in Born-Oppenheimer approximation, <span class="math notranslate nohighlight">\(N_p=2\)</span>. In the
literature, one can also find the <span class="math notranslate nohighlight">\(m\)</span>-particle reduced density
matrices normalized by a factor <span class="math notranslate nohighlight">\(1/m!\)</span>, which in that case would
be inherited by the trace conditions.</p>
<p>Also, the (in our case, as we use the wavefunction from VQE,
ground-state) energy can be computed by</p>
<p>where <span class="math notranslate nohighlight">\(h_0\)</span> denotes the nuclear repulsion energy, which is 0 for
Helium anyways.</p>
<p>Note, that the expressions above also hold true for the spin-RDMs, given
that the one- and two-body integrals are available in spin-orbital
basis.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Computation of consistency checks</span>
<span class="c1">#todo: normalization of rdm2 *= 1/2</span>
<span class="c1"># Trace</span>
<span class="n">tr1_spin</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pp&#39;</span><span class="p">,</span> <span class="n">rdm1_spin</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="s1">&#39;greedy&#39;</span><span class="p">)</span>
<span class="n">tr1_spinfree</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pp&#39;</span><span class="p">,</span> <span class="n">rdm1_spinfree</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="s1">&#39;greedy&#39;</span><span class="p">)</span>

<span class="n">tr2_spin</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pqpq&#39;</span><span class="p">,</span> <span class="n">rdm2_spin</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="s1">&#39;greedy&#39;</span><span class="p">)</span>
<span class="n">tr2_spinfree</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;pqpq&#39;</span><span class="p">,</span> <span class="n">rdm2_spinfree</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="s1">&#39;greedy&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1-RDM: N_true = 2, N_spin = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tr1_spin</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, N_spinfree = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tr1_spinfree</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2-RDM: N*(N-1)_true = 2, spin = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tr2_spin</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, spinfree = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tr2_spinfree</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>

<span class="c1"># Energy</span>
<span class="c1"># Get molecular integrals</span>
<span class="n">h0</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">molecule</span><span class="o">.</span><span class="n">nuclear_repulsion</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;h0 is zero: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">h0</span><span class="p">))</span>
<span class="n">h1</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">molecule</span><span class="o">.</span><span class="n">one_body_integrals</span>
<span class="n">h2</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">molecule</span><span class="o">.</span><span class="n">two_body_integrals</span>
<span class="c1"># Reorder two-body-integrals according to physics convention</span>
<span class="n">h2</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">chemistry</span><span class="o">.</span><span class="n">qc_base</span><span class="o">.</span><span class="n">NBodyTensor</span><span class="p">(</span><span class="n">elems</span><span class="o">=</span><span class="n">h2</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;openfermion&#39;</span><span class="p">)</span>
<span class="n">h2</span><span class="o">.</span><span class="n">reorder</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="s1">&#39;phys&#39;</span><span class="p">)</span>
<span class="n">h2</span> <span class="o">=</span> <span class="n">h2</span><span class="o">.</span><span class="n">elems</span>
<span class="c1"># Compute energy</span>
<span class="n">rdm_energy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;qp, pq&#39;</span><span class="p">,</span> <span class="n">h1</span><span class="p">,</span> <span class="n">rdm1_spinfree</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="s1">&#39;greedy&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;rspq, pqrs&#39;</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">rdm2_spinfree</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="s1">&#39;greedy&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">VQE-Energy is:      &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">vqe_energy</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RDM-energy matches: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rdm_energy</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>… for the definition of the reduced density matrices, spin-free
formulation, symmetries: 1. Kutzelnigg, W., Shamasundar, K. R. &amp;
Mukherjee, D. Spinfree formulation of reduced density matrices, density
cumulants and generalised normal ordering. Mol. Phys. 108, 433–451
(2010). 2. Helgaker, T., Jørgensen, P. &amp; Olsen, J. Molecular
Electronic-Structure Theory (John Wiley &amp; Sons, Ltd, 2000).</p>
</div>
<div class="section" id="possible-applications">
<h2>Possible applications<a class="headerlink" href="#possible-applications" title="Permalink to this headline">¶</a></h2>
<p>So far, the content of this notebook is comparably trivial, and misses
some interesting applications. An interesting possilibity on how to make
use of the RDM’s obtained by a quantum computer is given by a technique
that has been named quantum subspace expansion, which e.g. can be used
to approximate excited states [3], decode quantum errors [4] or improve
the accuracy of results [5]. References herefore: 3. McClean, J. R.,
Kimchi-Schwartz, M. E., Carter, J. &amp; De Jong, W. A. Hybrid
quantum-classical hierarchy for mitigation of decoherence and
determination of excited states. Phys. Rev. A 95, 1–10 (2017). 4.
McClean, J. R., Jiang, Z., Rubin, N. C., Babbush, R. &amp; Neven, H.
Decoding quantum errors with subspace expansions. Nat. Commun. 11, 1–9
(2020). 5. Takeshita, T. et al. Increasing the Representation Accuracy
of Quantum Simulations of Chemistry without Extra Quantum Resources.
Phys. Rev. X 10, 11004 (2020).</p>
<p>Everybody is invited to enrich this notebook by implementing one of the
techniques mentioned, or some other application of the 1- and 2-RDM!</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2020, Matter Lab.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.2.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>